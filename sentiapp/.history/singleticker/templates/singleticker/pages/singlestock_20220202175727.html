{% extends "singleticker/base.html" %} {% block content %}

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/solid.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">



<div id="chartdiv"></div>
<div id="app" class="container">
    <div class="row">
        <div id="ticke-title">
            <h1> $TSL </h1>
        </div>
    </div>
    <div class="row">
        <div id="left-ticker-container" class="col-sm">

            <div id="ticker-price">
                <div>
                    <h1> [[currentPrice]] </h1>
                </div>
                <div>
                    <p> + 2.60% ($74.72) </p>
                </div>
            </div>

        </div>




        <div id="left-ticker-container" class="col-sm">

            <div id="ticker-overview">
                <div class="row">

                    <div class="col">
                        <p> Market Cap : 123</p>
                    </div>
                    <div class="col">
                        <p> Market Cap : 123</p>
                    </div>
                    <div class="col">
                        <p> Market Cap : 123</p>
                    </div>


                    <div class="w-100"></div>
                    <div class="col">
                        <p> Market Cap : 123</p>
                    </div>
                    <div class="col">
                        <p> Market Cap : 123</p>
                    </div>
                    <div class="col">
                        <p> Market Cap : 123</p>
                    </div>

                    <div class="w-100"></div>
                    <div class="col">
                        <p> Market Cap : 123</p>
                    </div>
                    <div class="col">
                        <p> Market Cap : 123</p>
                    </div>
                    <div class="col">
                        <p> Market Cap : 123</p>
                    </div>



                </div>
            </div>

        </div>



    </div>

    <div class="row" style="margin-top: 50px;">
        <div id="left-graph-ticker-container" class="col-8">
            <div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">

                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-primary" @click.native="stockHistoryDynamics()">1D</button>

                </div>



                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="stockHistory5Days()">5D</button>

                </div>



                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="stockHistory1Month()">1M</button>

                </div>

                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="stockHistory3Months()">3M</button>

                </div>


                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="stockHistory1Year()">1Y</button>

                </div>

                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="stockHistory5Years()">5Y</button>

                </div>


                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="stockHistoryMax()">MAX</button>

                </div>



            </div>

            <canvas id="stockChart"></canvas>

        </div>
        <div id="right-tweet-container" class="col-4">
            <div class="list-group" v-if="tweet !== null">
                <a href="#" class="list-group-item list-group-item-action flex-column align-items-start active">
                    <div class="d-flex w-100 " style="margin-bottom : 10px;">
                        <img v-bind:src="tweet.user.profile_image_url" width="50" height="50" style="margin-right : 10px;">
                        <h5 class="mb-1">[[tweet.user.screen_name]] </h5>

                    </div>
                    <div style="word-wrap: break-word;">
                        <p class="mb-1">[[tweet.full_text]]
                        </p>
                        <small>[[tweet.created_at]]</small>
                    </div>
                </a>

            </div>
        </div>



    </div>



    <div class="row" style="margin-top: 50px;">
        <div id="left-graph-ticker-container" class="col-8">
            <div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">

                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-primary" @click.native="sentimentAnalysis24Hours()">1D</button>

                </div>



                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="sentimentAnalysisRange(5)">5D</button>

                </div>



                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="sentimentAnalysisRange(30)">1M</button>

                </div>

                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="sentimentAnalysisRange(90)">3M</button>

                </div>


                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="sentimentAnalysisRange(365)">1Y</button>

                </div>


                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="sentimentAnalysisRange(1825)">5Y</button>

                </div>

                <!-- <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="stockHistory5Years()">5Y</button>

                </div>


                <div class="btn-group mr-3" role="group" aria-label="Second group">
                    <button type="button" class="btn btn-secondary" @click.native="stockHistoryMax()">MAX</button>

                </div> -->



            </div>

            <canvas id="analysischart"></canvas>

        </div>
        <div id="right-tweet-container" class="col-4">
            <div class="card">

                <div class="card-body">
                    <h5 class="card-title">Sentiment Overview</h5>
                    <p class="card-text">Here you can see the public sentiment based on twitter over the last 24 hours </p>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">Compound :[[mean_24_compound]]</li>
                    <li class="list-group-item">Posivity :[[mean_24_positivity]] </li>
                    <li class="list-group-item">Negativity :[[mean_24_negativity]]</li>
                    <li class="list-group-item">Neutraility :[[mean_24_neutrality]]</li>
                    <li class="list-group-item">Polarity :[[mean_24_polarity]]</li>
                    <li class="list-group-item">Subjectivity :[[mean_24_subjectivity]] </li>
                </ul>

            </div>
        </div>



    </div>


    <div class="row" style="margin-top: 50px;height: 500px;">
        <div class="col">
            <canvas id="pieChart" width="100%" height="100%"></canvas>
        </div>

        <div class="col">
            <h2> Word CLoud </h2>
            <div id="myChart"></div>


        </div>



    </div>






    <!-- 
    {% autoescape off %}
    {{ tweets }}
    {% endautoescape %} -->

</div>

{% endblock %} {% block scripts %}
<script>
    // List of words
    // List of words

    //   const labelsx = [
    //     'January',
    //     'February',
    //     'March',
    //     'April',
    //     'May',
    //     'June',
    //   ];

    //   const data = {
    //     labels: labelsx,
    //     datasets: [{
    //       label: 'My First dataset',
    //       backgroundColor: 'rgb(255, 99, 132)',
    //       borderColor: 'rgb(255, 99, 132)',
    //       data: [0, 10, 5, 2, 20, 30, 45],
    //     }]
    //   };

    //   const config = {
    //                 type: 'line',
    //                 data: data,
    //                 options: {
    //                     xAxes: [{
    //                     type: 'time',
    //                     time: {
    //                         parser: 'YYYY-MM-DD HH:mm:ss',
    //                         unit: 'minute',
    //                         displayFormats: {
    //                             'minute': 'YYYY-MM-DD HH:mm:ss',
    //                             'hour': 'YYYY-MM-DD HH:mm:ss'
    //                         }
    //                     },
    //                     ticks: {
    //                         source: 'data'
    //                     }
    //                 }]        }
    //              };

    //   const myChart = new Chart(
    //     document.getElementById('myChart'),
    //     config
    //   );

    ZC.LICENSE = ["569d52cefae586f634c54f86dc99e6a9", "b55b025e438fa8a98e32482b5f768ff5"];
    zingchart.MODULESDIR = 'https://cdn.zingchart.com/modules/';





    let myApp = Vue.createApp({
        delimiters: ["[[", "]]"],
        data() {
            return {
                currentPrice: 0,
                stockSocket: null,
                labelsx: null,
                data: null,
                config: null,
                myChart: null,
                tweet: null,
                labelSentiment: [],
                dataSentiment: [],
                configSentiment: null,
                sentimentChart: null,


                mean_24_compound: 0,
                mean_24_positivity: 0,
                mean_24_negativity: 0,
                mean_24_neutrality: 0,
                mean_24_polarity: 0,
                mean_24_subjectivity: 0,





                labelsPiedChart: [],
                dataPieChart: [],
                configPieChart: null,
                pieChart: null,
                optionsPieChart: null,


                wordsClouds: [],
                margin: null,
                svg: null,
                layout: null,






            }
        },

        async created() {

            var stockPath = window.location.pathname.split('/');
            var stockSingle = stockPath[2]

            this.stockSocket = new WebSocket(
                'ws://' +
                window.location.host +
                '/ws/singlestock/' +
                stockSingle + '/'

            );
            console.log(this.stockSocket)
            let self = this
            this.stockSocket.onmessage = function(e) {
                if (typeof e !== 'undefined') {
                    var response = JSON.parse(e.data);
                    console.log(response);


                    if (response.hasOwnProperty('graph')) {
                        console.log("exustubgs")
                        var prices = response.graph.data.map(x => x.open);
                        console.log(prices)
                        var dates = response.graph.data.map(x => x.date);
                        console.log(dates);
                        self.myChart.data.labels = dates;
                        self.myChart.data.datasets[0].data = prices;
                        self.myChart.update();
                    } else if (response.hasOwnProperty('sentiment')) {

                        let data = await response.sentiment.json();
                        console.log("Sentiment data");
                        console.log(data)
                        this.mean_24_compound = data.mean_compound
                        this.mean_24_negativity = data.mean_negative
                        this.mean_24_neutrality = data.mean_neutral
                        this.mean_24_polarity = data.mean_polarity
                        this.mean_24_positivity = data.mean_positive

                        this.mean_24_subjectivity = data.mean_subjectivity
                        this.pieChart.data.datasets[0].data = [data.positive_count, data.negative_count, data.neutral_count];

                        this.pieChart.update();
                        this.sentimentChart.data.labels = data.dates;
                        this.sentimentChart.data.datasets[0].data = data.values_compound;
                        this.sentimentChart.data.datasets[1].data = data.values_positives;

                        this.sentimentChart.data.datasets[2].data = data.values_negatives;

                        this.sentimentChart.data.datasets[3].data = data.values_neutral;
                        this.sentimentChart.update();


                    } else {
                        self.currentPrice = response.latestPrice;

                    }

                };




            };

            this.stockSocket.onclose = function(e) {
                console.log(e.error)
                console.error('Chat socket closed unexpectedly');
            };


            //make a get request
            var pathArray = window.location.pathname.split('/');
            console.log(pathArray[2])
            var urlWithPath = "{%url 'singleticker:get_current_quote' 2000000000000000%}".replace("2000000000000000", pathArray[2])
            let response = await fetch(urlWithPath);
            if (response.ok) {
                let data = await response.json();
                console.log(data.stock_quote)
                this.currentPrice = data.stock_quote.latestPrice
            } else {
                alert("failed to load the list of hobbies");
            }









            this.labelsx = [

            ];

            this.data = {
                labels: this.labelsx,
                datasets: [{
                    label: 'Last 24 hours',
                    backgroundColor: 'rgb(255, 99, 132)',
                    borderColor: 'rgb(255, 99, 132)',
                    data: [],
                }]
            };

            this.config = {
                type: 'line',
                data: this.data,
                options: {
                    responsive: true,
                    xAxes: [{
                        type: 'time',
                        time: {
                            parser: 'YYYY-MM-DD HH:mm:ss',
                            unit: 'minute',
                            displayFormats: {
                                'minute': 'YYYY-MM-DD HH:mm:ss',
                                'hour': 'YYYY-MM-DD HH:mm:ss'
                            }
                        },
                        ticks: {
                            source: 'data'
                        }
                    }]
                }
            };



            this.myChart = new Chart(
                document.getElementById('stockChart'),
                this.config
            );
            var pathArray = window.location.pathname.split('/');

            var histogramPath = "{%url 'singleticker:get_time_history' 2000000000000000 50000000000000%}".replace("2000000000000000", pathArray[2])
            histogramPath = histogramPath.replace("50000000000000", "5d")
            let responseHistogram = await fetch(histogramPath);
            if (responseHistogram.ok) {
                let data = await responseHistogram.json();

                //change data.map for dynamic
                var prices = data.stock_quote.map(x => x.open);
                console.log(prices)
                var dates = data.stock_quote.map(x => x.label);
                console.log(dates);

                // console.log(data.stock_quote)


                // var mybarChart = document.getElementById('myChart');

                // console.log(mybarChart);
                console.log(dates);

                this.myChart.data.labels = dates;
                this.myChart.data.datasets[0].data = prices;
                this.myChart.update();
            } else {
                alert("failed to load the list of hobbies");
            }




            //TWEET
            var urlWithPathTweet = "{%url 'singleticker:get_hot_tweet' %}";
            let responseTweet = await fetch(urlWithPathTweet);
            if (responseTweet.ok) {
                let data = await responseTweet.json();
                console.log("TWEET");
                data = JSON.parse(data.tweet);
                this.tweet = data;
                console.log(data)



            } else {
                console.log(response.error)
                alert("failed to load the list of hobbies");
            }




            this.labelSentiment = [

            ];

            this.dataSentiment = {
                labels: this.labelSentiment,
                datasets: [{
                        label: 'Compound',
                        backgroundColor: 'rgb(255, 99, 132)',
                        borderColor: 'rgb(255, 99, 132)',
                        fill: false,
                        data: [],
                    }, {
                        label: 'Positve',
                        backgroundColor: 'rgb(120, 92, 22)',
                        borderColor: 'rgb(120, 92, 22)',
                        fill: false,
                        data: [],
                    }, {
                        label: 'Negative',
                        backgroundColor: 'rgb(189, 185, 185)',
                        borderColor: 'rgb(189, 185, 185)',
                        fill: false,
                        data: [],
                    },

                    {
                        label: 'Neutral',
                        backgroundColor: 'rgb(68, 201, 126)',
                        borderColor: 'rgb(68, 201, 126)',
                        fill: false,
                        data: [],
                    },


                ]
            };

            this.configSentiment = {
                type: 'line',
                data: this.dataSentiment,
                options: {
                    responsive: true,
                    xAxes: [{
                        type: 'time',
                        time: {
                            parser: 'YYYY-MM-DD HH:mm:ss',
                            unit: 'minute',
                            displayFormats: {
                                'minute': 'YYYY-MM-DD HH:mm:ss',
                                'hour': 'YYYY-MM-DD HH:mm:ss'
                            }
                        },
                        ticks: {
                            source: 'data'
                        }
                    }]
                }
            };



            this.sentimentChart = new Chart(
                document.getElementById('analysischart'),
                this.configSentiment
            );





            this.labelsPiedChart = [];

            this.dataPieChart = {
                labels: ["Positive", "Negative", "Neutral"],
                datasets: [{
                    label: 'Last 24 hours',
                    backgroundColor: [
                        'rgb(255, 99, 132)',
                        'rgb(54, 162, 235)',
                        'rgb(255, 205, 86)'
                    ],
                    hoverOffset: 4,
                    data: [],
                }]
            };

            // this.configPieChart = {
            //     type: 'doughnut',
            //     data: data,
            // };

            this.optionsPieChart = {
                responsive: true,
                title: {
                    display: true,
                    position: "top",
                    text: "Tweet Analyzed Count",
                    fontSize: 30,
                    fontColor: "#111"
                },
                legend: {
                    display: true,
                    position: "bottom",
                    labels: {
                        fontColor: "#333",
                        fontSize: 16
                    }
                },
                plugins: {
                    labels: {
                        render: 'label',
                        arc: true,
                        fontColor: '#000',
                        position: 'outside',
                        fontSize: 16
                    }
                }
            };
            this.configPieChart = {
                type: 'doughnut',
                data: this.dataPieChart,
                options: this.optionsPieChart
            };




            this.pieChart = new Chart(
                document.getElementById('pieChart'),
                this.configPieChart,

            );










            //GET SENTIMENT DATA


            var urlWithSentiment = "{%url 'singleticker:get_24_hours_sentiment' 2000000000000000 %}".replace("2000000000000000", pathArray[2]);
            let responseSentiment = await fetch(urlWithSentiment);
            if (responseSentiment.ok) {
                let data = await responseSentiment.json();
                console.log("Sentiment data");
                console.log(data)
                this.mean_24_compound = data.mean_compound
                this.mean_24_negativity = data.mean_negative
                this.mean_24_neutrality = data.mean_neutral
                this.mean_24_polarity = data.mean_polarity
                this.mean_24_positivity = data.mean_positive

                this.mean_24_subjectivity = data.mean_subjectivity
                this.pieChart.data.datasets[0].data = [data.positive_count, data.negative_count, data.neutral_count];

                this.pieChart.update();
                this.sentimentChart.data.labels = data.dates;
                this.sentimentChart.data.datasets[0].data = data.values_compound;
                this.sentimentChart.data.datasets[1].data = data.values_positives;

                this.sentimentChart.data.datasets[2].data = data.values_negatives;

                this.sentimentChart.data.datasets[3].data = data.values_neutral;
                this.sentimentChart.update();

                var myConfig = {
                    type: 'wordcloud',
                    options: {
                        text: data.word_cloud_data,
                        ignore: ["America", "American", "Applause", "Because", "because", "could", "don’t", "people", "That’s", "that’s", "Their", "their", "there", "these", "thing", "those", "through", "We’re", "we’re", "where", "would"],
                        maxItems: 200,
                        aspect: 'flow-center',

                        colorType: 'palette',
                        palette: ['#D32F2F', '#5D4037', '#1976D2', '#E53935', '#6D4C41', '#1E88E5', '#F44336', '#795548', '#2196F3', '#EF5350', '#8D6E63', '#42A5F5'],

                        style: {
                            fontFamily: 'Crete Round',

                            hoverState: {
                                backgroundColor: '#D32F2F',
                                borderRadius: 2,
                                fontColor: 'white'
                            },
                            tooltip: {
                                text: '%text: %hits',
                                visible: true,
                                alpha: 0.9,
                                backgroundColor: '#1976D2',
                                borderRadius: 2,
                                borderColor: 'none',
                                fontColor: 'white',
                                fontFamily: 'Georgia',
                                textAlpha: 1
                            }
                        }
                    },

                    source: {
                        // text: '--President Barack Obama<br> Selma 50th anniversary speech<br>March 7, 2015',
                        // //Source: https://obamawhitehouse.archives.gov/the-press-office/2015/03/07/remarks-president-50th-anniversary-selma-montgomery-marches
                        // fontColor: '#64B5F6',
                        // fontSize: 10,
                        // fontFamily: 'Georgia',
                        // fontWeight: 'normal',
                        // marginBottom: '10%'
                    }


                };

                zingchart.render({
                    id: 'myChart',
                    data: myConfig,
                    height: '500',
                    width: '100%'
                });



            } else {
                console.log(response.error)
                alert("failed to load the list of hobbies");
            }



        },
        methods: {

            async stockHistoryDynamics() {
                var pathArray = window.location.pathname.split('/');
                var histogramPath = "{%url 'singleticker:get_time_history' 2000000000000000 50000000000000%}".replace("2000000000000000", pathArray[2])
                histogramPath = histogramPath.replace("50000000000000", "dynamic")
                let responseHistogram = await fetch(histogramPath);
                if (responseHistogram.ok) {
                    let data = await responseHistogram.json();

                    //change data.map for dynamic
                    var prices = data.stock_quote.data.map(x => x.open);
                    console.log(prices)
                    var dates = data.stock_quote.data.map(x => x.date);
                    console.log(dates);

                    console.log(data.stock_quote)


                    // var mybarChart = document.getElementById('myChart');

                    // console.log(mybarChart);
                    console.log(dates);

                    this.myChart.data.labels = dates;
                    this.myChart.data.datasets[0].data = prices;
                    this.myChart.update();
                } else {
                    alert("failed to load the list of hobbies");
                }





            },
            async stockHistory5Days() {
                var pathArray = window.location.pathname.split('/');
                var histogramPath = "{%url 'singleticker:get_time_history' 2000000000000000 50000000000000%}".replace("2000000000000000", pathArray[2])
                histogramPath = histogramPath.replace("50000000000000", "5d")
                let responseHistogram = await fetch(histogramPath);
                if (responseHistogram.ok) {
                    let data = await responseHistogram.json();

                    //change data.map for dynamic
                    var prices = data.stock_quote.map(x => x.open);
                    console.log(prices)
                    var dates = data.stock_quote.map(x => x.date);
                    console.log(dates);

                    console.log(data.stock_quote)


                    // var mybarChart = document.getElementById('myChart');

                    // console.log(mybarChart);
                    console.log(dates);

                    this.myChart.data.labels = dates;
                    this.myChart.data.datasets[0].data = prices;
                    this.myChart.update();
                } else {
                    alert("failed to load the list of hobbies");
                }





            },
            async stockHistory1Month() {
                var pathArray = window.location.pathname.split('/');
                var histogramPath = "{%url 'singleticker:get_time_history' 2000000000000000 50000000000000%}".replace("2000000000000000", pathArray[2])
                histogramPath = histogramPath.replace("50000000000000", "1m")
                let responseHistogram = await fetch(histogramPath);
                if (responseHistogram.ok) {
                    let data = await responseHistogram.json();

                    //change data.map for dynamic
                    var prices = data.stock_quote.map(x => x.open);
                    console.log(prices)
                    var dates = data.stock_quote.map(x => x.date);
                    console.log(dates);

                    console.log(data.stock_quote)


                    // var mybarChart = document.getElementById('myChart');

                    // console.log(mybarChart);
                    console.log(dates);

                    this.myChart.data.labels = dates;
                    this.myChart.data.datasets[0].data = prices;
                    this.myChart.update();
                } else {
                    alert("failed to load the list of hobbies");
                }





            },


            async stockHistory3Months() {
                var pathArray = window.location.pathname.split('/');
                var histogramPath = "{%url 'singleticker:get_time_history' 2000000000000000 50000000000000%}".replace("2000000000000000", pathArray[2])
                histogramPath = histogramPath.replace("50000000000000", "3m")
                let responseHistogram = await fetch(histogramPath);
                if (responseHistogram.ok) {
                    let data = await responseHistogram.json();

                    //change data.map for dynamic
                    var prices = data.stock_quote.map(x => x.open);
                    console.log(prices)
                    var dates = data.stock_quote.map(x => x.date);
                    console.log(dates);

                    console.log(data.stock_quote)


                    // var mybarChart = document.getElementById('myChart');

                    // console.log(mybarChart);
                    console.log(dates);

                    this.myChart.data.labels = dates;
                    this.myChart.data.datasets[0].data = prices;
                    this.myChart.update();
                } else {
                    alert("failed to load the list of hobbies");
                }





            },
            async stockHistory1Year() {
                var pathArray = window.location.pathname.split('/');
                var histogramPath = "{%url 'singleticker:get_time_history' 2000000000000000 50000000000000%}".replace("2000000000000000", pathArray[2])
                histogramPath = histogramPath.replace("50000000000000", "1y")
                let responseHistogram = await fetch(histogramPath);
                if (responseHistogram.ok) {
                    let data = await responseHistogram.json();

                    //change data.map for dynamic
                    var prices = data.stock_quote.map(x => x.open);
                    console.log(prices)
                    var dates = data.stock_quote.map(x => x.date);
                    console.log(dates);

                    console.log(data.stock_quote)


                    // var mybarChart = document.getElementById('myChart');

                    // console.log(mybarChart);
                    console.log(dates);

                    this.myChart.data.labels = dates;
                    this.myChart.data.datasets[0].data = prices;
                    this.myChart.update();
                } else {
                    alert("failed to load the list of hobbies");
                }





            },

            async stockHistory5Years() {
                var pathArray = window.location.pathname.split('/');
                var histogramPath = "{%url 'singleticker:get_time_history' 2000000000000000 50000000000000%}".replace("2000000000000000", pathArray[2])
                histogramPath = histogramPath.replace("50000000000000", "5y")
                let responseHistogram = await fetch(histogramPath);
                if (responseHistogram.ok) {
                    let data = await responseHistogram.json();

                    //change data.map for dynamic
                    var prices = data.stock_quote.map(x => x.open);
                    console.log(prices)
                    var dates = data.stock_quote.map(x => x.date);
                    console.log(dates);

                    console.log(data.stock_quote)


                    // var mybarChart = document.getElementById('myChart');

                    // console.log(mybarChart);
                    console.log(dates);

                    this.myChart.data.labels = dates;
                    this.myChart.data.datasets[0].data = prices;
                    this.myChart.update();
                } else {
                    alert("failed to load the list of hobbies");
                }





            },


            async stockHistoryMax() {
                var pathArray = window.location.pathname.split('/');
                var histogramPath = "{%url 'singleticker:get_time_history' 2000000000000000 50000000000000%}".replace("2000000000000000", pathArray[2])
                histogramPath = histogramPath.replace("50000000000000", "max")
                let responseHistogram = await fetch(histogramPath);
                if (responseHistogram.ok) {
                    let data = await responseHistogram.json();

                    //change data.map for dynamic
                    var prices = data.stock_quote.map(x => x.open);
                    console.log(prices)
                    var dates = data.stock_quote.map(x => x.date);
                    console.log(dates);

                    console.log(data.stock_quote)


                    // var mybarChart = document.getElementById('myChart');

                    // console.log(mybarChart);
                    console.log(dates);

                    this.myChart.data.labels = dates;
                    this.myChart.data.datasets[0].data = prices;
                    this.myChart.update();
                } else {
                    alert("failed to load the list of hobbies");
                }





            },



            async sentimentAnalysis24Hours() {
                var pathArray = window.location.pathname.split('/');

                var urlWithSentiment = "{%url 'singleticker:get_24_hours_sentiment' 2000000000000000 %}".replace("2000000000000000", pathArray[2]);
                let responseSentiment = await fetch(urlWithSentiment);

                if (responseSentiment.ok) {
                    let data = await responseSentiment.json();
                    console.log("Sentiment data");
                    console.log(data)
                    this.mean_24_compound = data.mean_compound
                    this.mean_24_negativity = data.mean_negative
                    this.mean_24_neutrality = data.mean_neutral
                    this.mean_24_polarity = data.mean_polarity
                    this.mean_24_positivity = data.mean_positive

                    this.mean_24_subjectivity = data.mean_subjectivity
                    this.pieChart.data.datasets[0].data = [data.positive_count, data.negative_count, data.neutral_count];

                    this.pieChart.update();
                    this.sentimentChart.data.labels = data.dates;
                    this.sentimentChart.data.datasets[0].data = data.values_compound;
                    this.sentimentChart.data.datasets[1].data = data.values_positives;

                    this.sentimentChart.data.datasets[2].data = data.values_negatives;

                    this.sentimentChart.data.datasets[3].data = data.values_neutral;
                    this.sentimentChart.update();





                }
            },
            async sentimentAnalysisRange(time_range) {
                var pathArray = window.location.pathname.split('/');

                var urlWithSentiment = "{%url 'singleticker:get_time_range_sentiment' 2000000000000000 50000000000000%}".replace("2000000000000000", pathArray[2]);
                var urlWithSentimeWithDaterange = urlWithSentiment.replace('50000000000000', time_range)
                let responseSentiment = await fetch(urlWithSentimeWithDaterange);
                if (responseSentiment.ok) {
                    let data = await responseSentiment.json();
                    console.log("Sentiment data");
                    console.log(data)
                    this.mean_24_compound = data.mean_compound
                    this.mean_24_negativity = data.mean_negative
                    this.mean_24_neutrality = data.mean_neutral
                    this.mean_24_polarity = data.mean_polarity
                    this.mean_24_positivity = data.mean_positive

                    this.mean_24_subjectivity = data.mean_subjectivity
                    this.pieChart.data.datasets[0].data = [data.positive_count, data.negative_count, data.neutral_count];

                    this.pieChart.update();
                    this.sentimentChart.data.labels = data.dates;
                    this.sentimentChart.data.datasets[0].data = data.values_compound;
                    this.sentimentChart.data.datasets[1].data = data.values_positives;

                    this.sentimentChart.data.datasets[2].data = data.values_negatives;

                    this.sentimentChart.data.datasets[3].data = data.values_neutral;
                    this.sentimentChart.update();

                    // let output = zingchart.exec('mychart', 'updateobject', {
                    //     type: 'wordcloud',
                    //     options: {
                    //         text: data.word_cloud_data,
                    //         ignore: ["America", "American", "Applause", "Because", "because", "could", "don’t", "people", "That’s", "that’s", "Their", "their", "there", "these", "thing", "those", "through", "We’re", "we’re", "where", "would"],
                    //         maxItems: 200,
                    //         aspect: 'flow-center',

                    //         colorType: 'palette',
                    //         palette: ['#D32F2F', '#5D4037', '#1976D2', '#E53935', '#6D4C41', '#1E88E5', '#F44336', '#795548', '#2196F3', '#EF5350', '#8D6E63', '#42A5F5'],

                    //         style: {
                    //             fontFamily: 'Crete Round',

                    //             hoverState: {
                    //                 backgroundColor: '#D32F2F',
                    //                 borderRadius: 2,
                    //                 fontColor: 'white'
                    //             },
                    //             tooltip: {
                    //                 text: '%text: %hits',
                    //                 visible: true,
                    //                 alpha: 0.9,
                    //                 backgroundColor: '#1976D2',
                    //                 borderRadius: 2,
                    //                 borderColor: 'none',
                    //                 fontColor: 'white',
                    //                 fontFamily: 'Georgia',
                    //                 textAlpha: 1
                    //             }
                    //         }
                    //     }
                    // });
                    // zcdocs.demos.dump('updateobject', output);



                }
            },








        }
    });
    myApp.mount('#app');
</script>
{% endblock %}